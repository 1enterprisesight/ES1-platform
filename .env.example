# ===========================================================================
# ES1 Platform Configuration
# ===========================================================================
# Copy to .env and customize. All values shown are the defaults used when
# a variable is not set. For local development, no changes are needed.
#
# Pattern: ${VAR:-default} in compose files means the variable is optional.
# If not set, the default value after :- is used.
# ===========================================================================

# ===========================================================================
# General
# ===========================================================================
ENVIRONMENT=development

# Prefix for all container names (e.g., es1-postgres, es1-redis)
# Change this to avoid conflicts when running multiple instances
CONTAINER_PREFIX=es1

# Platform Branding
# These control all user-visible branding across the platform
PLATFORM_NAME=ES1
PAGE_TITLE=Platform
META_DESCRIPTION=Enterprise AI Platform
FAVICON_URL=
WEBUI_NAME=ES1 AI Chat

# ===========================================================================
# Authentication
# ===========================================================================
# Auth mode: "none" (local dev), "api-key" (production), "oidc" (enterprise SSO)
AUTH_MODE=none

# Default admin API key (only used when AUTH_MODE=api-key)
# IMPORTANT: Change this in production!
DEFAULT_API_KEY=es1-dev-key-change-in-production

# Prefix for generated API keys
API_KEY_PREFIX=pk

# JWT signing secret (for OIDC/session tokens)
# Generate with: openssl rand -base64 32
JWT_SECRET=

# CORS origins (JSON array). Set to specific origins in production.
# Example: '["http://localhost:3001","https://platform.example.com"]'
CORS_ORIGINS=["*"]

# ===========================================================================
# Container Registry
# ===========================================================================
REGISTRY=ghcr.io/1enterprisesight/es1-platform

# ===========================================================================
# Main PostgreSQL (6 databases: platform_manager, airflow, langfuse, langflow, n8n, mlflow)
# ===========================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=es1_platform
POSTGRES_USER=es1_user
POSTGRES_PASSWORD=es1_dev_password

# ===========================================================================
# AIML PostgreSQL (pgvector for RAG/embeddings)
# ===========================================================================
AIML_POSTGRES_HOST=aiml-postgres
AIML_POSTGRES_PORT=5432
AIML_POSTGRES_DB=aiml
AIML_POSTGRES_USER=aiml_user
AIML_POSTGRES_PASSWORD=aiml_dev_password

# ===========================================================================
# Redis
# ===========================================================================
REDIS_HOST=redis
REDIS_PORT=6379

# ===========================================================================
# Airflow
# ===========================================================================
# IMPORTANT: Generate Fernet key for production:
#   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
AIRFLOW_FERNET_KEY=
AIRFLOW_WEBSERVER_SECRET=
AIRFLOW_ADMIN_USERNAME=airflow
AIRFLOW_ADMIN_PASSWORD=airflow
# Set to false in production (exposes connection strings and passwords)
AIRFLOW_EXPOSE_CONFIG=true
# CORS — restrict in production
AIRFLOW_CORS_ALLOW_ORIGINS=*

# ===========================================================================
# Langfuse
# ===========================================================================
# Auth secrets — CHANGE IN PRODUCTION (generate with: openssl rand -base64 32)
LANGFUSE_NEXTAUTH_SECRET=es1-langfuse-dev-secret-change-in-production
LANGFUSE_SALT=es1-langfuse-salt-change-in-production

# Headless initialization (auto-created on first start)
LANGFUSE_INIT_ORG_ID=es1-org
LANGFUSE_INIT_ORG_NAME=ES1 Platform
LANGFUSE_INIT_USER_EMAIL=admin@es1.local
LANGFUSE_INIT_USER_NAME=ES1 Admin
LANGFUSE_INIT_USER_PASSWORD=Es1admin!
LANGFUSE_INIT_PROJECT_ID=es1-platform
LANGFUSE_INIT_PROJECT_NAME=ES1 Platform
LANGFUSE_INIT_PROJECT_PUBLIC_KEY=pk-lf-es1-dev-public-key
LANGFUSE_INIT_PROJECT_SECRET_KEY=sk-lf-es1-dev-secret-key

# ===========================================================================
# Langflow
# ===========================================================================
LANGFLOW_SUPERUSER=admin
LANGFLOW_SUPERUSER_PASSWORD=admin
# Set to false in production to require login
LANGFLOW_AUTO_LOGIN=true
LANGFLOW_NEW_USER_IS_ACTIVE=true

# ===========================================================================
# n8n
# ===========================================================================
N8N_DEFAULT_USER_EMAIL=admin@es1.local
N8N_DEFAULT_USER_PASSWORD=Es1admin!
N8N_DEFAULT_USER_FIRST_NAME=ES1
N8N_DEFAULT_USER_LAST_NAME=Admin
N8N_WEBHOOK_URL=http://localhost:5678/
# Set to true in production (requires HTTPS)
N8N_SECURE_COOKIE=false
# Generate with: openssl rand -hex 32
N8N_ENCRYPTION_KEY=

# n8n API key (generate in n8n: Settings > API > Create API Key)
# N8N_API_KEY=

# ===========================================================================
# Open WebUI
# ===========================================================================
# Set to true in production to require login
WEBUI_AUTH=false

# ===========================================================================
# Grafana
# ===========================================================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ROOT_URL=http://localhost:3002
# Set to false in production
GRAFANA_ANONYMOUS_ENABLED=true
GRAFANA_ALLOW_EMBEDDING=true

# ===========================================================================
# KrakenD API Gateway — Backend Routing
# Override backend hostnames for Kubernetes or custom deployments
# Defaults are Docker Compose service names
# ===========================================================================
KRAKEND_GATEWAY_NAME=Platform API Gateway
# KRAKEND_BACKEND_PLATFORM_API=es1-platform-manager-api:8000
# KRAKEND_BACKEND_AIRFLOW=airflow-webserver:8080
# KRAKEND_BACKEND_LANGFLOW=langflow:7860
# KRAKEND_BACKEND_LANGFUSE=langfuse:3000
# KRAKEND_BACKEND_OLLAMA=ollama:11434
# KRAKEND_BACKEND_MLFLOW=mlflow:5000
# KRAKEND_BACKEND_N8N=n8n:5678

# ===========================================================================
# Kubernetes Settings (used when RUNTIME_MODE=kubernetes)
# ===========================================================================
K8S_NAMESPACE=es1-platform
KRAKEND_NAMESPACE=es1-infrastructure
KRAKEND_CONFIGMAP_NAME=krakend-config
KRAKEND_DEPLOYMENT_NAME=krakend

# ===========================================================================
# Platform Manager UI — External Service URLs
# These URLs are opened in the browser (not internal service-to-service)
# For Docker Compose, they use localhost with exposed host ports
# For Kubernetes, override with Ingress/LoadBalancer URLs
# ===========================================================================
GRAFANA_URL=http://localhost:3002
PROMETHEUS_URL=http://localhost:9090
LANGFLOW_URL=http://localhost:7860
MLFLOW_URL=http://localhost:5050
N8N_URL=http://localhost:5678
AIRFLOW_URL=http://localhost:8081
CREWAI_URL=http://localhost:8100
CREWAI_STUDIO_URL=http://localhost:8501
AUTOGEN_URL=http://localhost:8101
LANGFUSE_URL=http://localhost:3000
OPEN_WEBUI_URL=http://localhost:3010
AUTOGEN_STUDIO_URL=http://localhost:8502

# ===========================================================================
# Feature Flags
# ===========================================================================
ENABLE_N8N=true
ENABLE_LANGFLOW=true
ENABLE_CREWAI_STUDIO=true
ENABLE_AUTOGEN_STUDIO=true
ENABLE_LANGFUSE=true
ENABLE_MLFLOW=true

# ===========================================================================
# Ollama
# ===========================================================================
# OLLAMA_BASE_URL=http://ollama:11434
# OLLAMA_EMBEDDING_MODEL=nomic-embed-text
